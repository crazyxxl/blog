<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="740px" height="591px" viewBox="-0.5 -0.5 740 591" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2022-01-05T14:29:26.034Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.9.9 Chrome/85.0.4183.121 Electron/10.1.5 Safari/537.36&quot; etag=&quot;cDcwgxj1JmK96GvLS4k7&quot; version=&quot;13.9.9&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;Wr4-TBDzsJpm_d5B4bmE&quot; name=&quot;第 1 页&quot;&gt;5VpLk5s4EP41Om7KPATiCDbeHGarUpnDZk9bDGgMWYxcGI/H+fXbLcQbbJzEk5nJZUZqSd1SP75uJBNjuX3+Mw928V8i4inRF9EzMVZE1zVDt+AfUk4lxXZYSdjkSaQmNYT75BtXxIWiHpKI7zsTCyHSItl1iaHIMh4WHVqQ5+LYnfYo0q7UXbDhA8J9GKRD6t9JVMQllel2Q//Ik01cSdYspxzZBtVkdZJ9HETi2CIZPjGWuRBF2do+L3mKyqv0Uq5bT4zWG8t5VsxZQO0kXt/5xwP78vEYin99+vT1D2WdpyA9qAMTnxLXJy40LMIY8Wzi28T1iLtW5yhOlXLgSDtsHrbpXfLI0ySDnrfjebLlBc9hJFXkTw3NO8ZJwe93QYhLj+A2QIuLbQo9DZpgySKAJXndT9Ngt08epNQFUHIeHvJ98sQ/833pMEgVhwIlLWtHQKI6Hs8L/jypN622BrgxF7DP/ART1ILagKfKM1X/2PhDTYtbvkAdRQyUD25q3o2ZoKEsdYXV2NBqfdO0FLoTSVbILVCP0FXPQiIvYrERWZC2bTRLb9MeNalMk3Z06YypcqhJU7uVJp3LmuRZ5CKQoK52PAPlAGWdpJV6oadgS9O7nlyy4tEAYeaoEHAuyDf83Dx7XNVtZVpKcTlPgwIipouPI9pU7D6hzzRms3oh0LfHXhzykKtFbQzq8RnEUp9ReeYBIzBAcGpNUy49uV+NjctpXKXk2DhOrb/v9yXNfLNhSbthWQfhpbi8VVhqdKBKg/gGAbMyjfiMuJCSDMxQjk8ARJCylkMm8RziWrKxJq4ms5g2lrwwLu9Vt9G231DboRykySbDfMYf4ezeHrJXkm3uZG+llyhQocRDKsL/ME2JQxbxSGUiME9++lJjBnT+6eSoAUxcDP/K377X9j8ZE/rZbgITrg1lRkfF3DaS326C7Ufy3Ax7s0geZlizFckWcRcYsRilK6w7RyIZhhycD4UpWxLwB2jAsaAkhcLUcQkzR6Id5yyJyyRGGMgc56yQCKs8g3hyOfx11qrSdaQsD6SsFcQAEfk4ks9wYw5y9nxJgdGVlAXboGoy1tClCKei0DE+9SlsZIIM5QFxz/UQxYO7SylUn+CzJt4SVQRDzJNzhvuhsqafh5gNQ3kK164aq9oGluKIJyyPWqLySqoV+LpqQ0oYnAHESAj3TNzZ+0Nl9ppQWbdfBJUrMTdF5QqE3z4qG/YvRmWopvqqpGdReQ781Ch4HrTKyo3K5RJxAZIR6mCyK+Gnum1AjFgTR/JxPKz0zgktly9anCFpGBK5JUIx6/1hTRUArwNrDPoiWFOJuS3WvJsK0KS/GmuGFaB1FmuuQoQaa+bUM32EioN9LLnDR6Qtiz+DOLRTSOFVqFbP2R8evuLlYpcBxbPACmiAaK9CJQb9RmTNagiB9RkslI7FWUsXbnVgaKCahkWejbrwWFU1Lltz6tpsWInJkhrkljpldmdVv7T7HQs5/VUVcqbxIuBaibkpuNpDbD0T9H3H+i0eHcz+7crcRwdjcbMv+cUrTokTV+Hjrw7ags5KiexmqtQGqtQ+yA9oU36kM0RfddF57bUmqK4YB9cQVCjVjApOwiB11cA2iSKJyDm6dtD4/NCGwaEQyv21n+Pphjlxj3jJ0/WbWWf4nal3Lp9nfZWct1LLPH1rPIiiENtuzlMPTxGUGzLjdd+d2Ly3pgk7/GCeogujY786cV39NmTrH+h5VhOvQ5fzEnSbh/ZyevNzBcP/Hw==&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="0" y="0" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 50 40 L 50 590" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 20px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">客户端</div></div></div></foreignObject><text x="50" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">客户端</text></switch></g><rect x="45" y="90" width="10" height="410" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 60 110 L 170 110 Q 180 110 190 110 L 287.26 110" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 275.38 116.5 L 288.38 110 L 275.38 103.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><rect x="55" y="210" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 60 190 L 85 190 L 85 210 L 73.12 210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 66.12 210 L 73.12 206.5 L 73.12 213.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 198px; margin-left: 89px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">3、解析证书信息</div></div></div></foreignObject><text x="89" y="201" fill="#000000" font-family="Helvetica" font-size="11px">3、解析证书信息</text></switch></g><rect x="55" y="290" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 60 270 L 85 270 L 85 290 L 73.12 290" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 66.12 290 L 73.12 286.5 L 73.12 293.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 278px; margin-left: 89px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">4、根据证书所包含的信息在操作系统或浏览器证书链中查询给该证书的签名的公钥证书，若查询到证书信息，继续5否则结束验证失败</div></div></div></foreignObject><text x="89" y="281" fill="#000000" font-family="Helvetica" font-size="11px">4、根据证书所包含的信息在操作系统或浏览器证书链中查询给该证书的签名的公钥证书，若查询到证书信息，继续5否则结束验证失败</text></switch></g><rect x="55" y="370" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 60 350 L 85 350 L 85 370 L 73.12 370" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 66.12 370 L 73.12 366.5 L 73.12 373.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 358px; margin-left: 89px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">5、根据公钥证书中的公钥解密服务端返回证书中加密部分</div></div></div></foreignObject><text x="89" y="361" fill="#000000" font-family="Helvetica" font-size="11px">5、根据公钥证书中的公钥解密服务端返回证书中加密部分</text></switch></g><rect x="55" y="450" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 60 430 L 85 430 L 85 450 L 73.12 450" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 66.12 450 L 73.12 446.5 L 73.12 453.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 438px; margin-left: 89px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">6、根据服务端返回的证书信息中的hash算法，计算subject的hash值并与5中计解密的数据比对，若相同，则验证通过，否则验证失败</div></div></div></foreignObject><text x="89" y="441" fill="#000000" font-family="Helvetica" font-size="11px">6、根据服务端返回的证书信息中的hash算法，计算subject的hash值并与5中计解密的数据比对，若相同，则验证通过，否则验证失败</text></switch></g><rect x="240" y="0" width="100" height="40" fill="#ffffff" stroke="#000000" pointer-events="all"/><path d="M 290 40 L 290 300" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 20px; margin-left: 241px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">服务端</div></div></div></foreignObject><text x="290" y="24" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">服务端</text></switch></g><rect x="285" y="105" width="10" height="80" fill="#ffffff" stroke="#000000" pointer-events="all"/><rect x="120" y="90" width="100" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 100px; margin-left: 170px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; ">1.索要证书信息</div></div></div></foreignObject><text x="170" y="104" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">1.索要证书信息</text></switch></g><path d="M 283 160 L 54.74 160" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke"/><path d="M 62.62 155.5 L 53.62 160 L 62.62 164.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 157px; margin-left: 168px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; ">2、返回证书信息</div></div></div></foreignObject><text x="168" y="157" fill="#000000" font-family="Helvetica" font-size="11px" text-anchor="middle">2、返回证书信息</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>